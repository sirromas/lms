<!DOCTYPE html>
<html lang="en">
<head>

    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"
          integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">

    <title>NewsFacts & Analysis</title>

    <!-- Site CSS -->
    <link rel="stylesheet" href="assets/css/site.css">

</head>
<body>

<nav class="navbar navbar-expand-lg navbar-light bg-light">
    <a class="navbar-brand" href="#" style="font-size: 14px;">NewsFacts & Analysis</a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse" id="navbarSupportedContent">
        <ul class="navbar-nav mr-auto">
            <li class="nav-item active">
                <a class="nav-link" href="https://www.newsfactsandanalysis.com/index.html">Home <span class="sr-only">(current)</span></a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="https://www.newsfactsandanalysis.com/about.html" target="_blank">About</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="mailto:info@newsfactsandanalysis.com">Contact</a>
            </li>
        </ul>

    </div>
</nav>


<body>


<div class="panel panel-default" style="margin-top: 10px;margin-left:10px;width:95%;text-align:center;">
    <div class="panel-heading">
        <div class="text-center">
            <div align="center">
                                    <span class="ds1">
                                        <h3>University Student Registration<br>
                                        </h3>
                                        <h4>($<span id="ui_price">30</span> per semester)</h4>
                                        <input type="hidden" id="price" value="30">
                                    </span></div>
        </div>
    </div>
    <div class="panel-body">
        <form id="student_signup" method="post" _lpchecked="1">
            <div class="form-group">
                <div align="left">
                    <label for="first">First Name*</label> <input type="text" class="form-control" id="first"
                                                                  name="first" required=""
                                                                  placeholder="Enter Your Firstname"
                                                                  style="background-image: url(&quot;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAfBJREFUWAntVk1OwkAUZkoDKza4Utm61iP0AqyIDXahN2BjwiHYGU+gizap4QDuegWN7lyCbMSlCQjU7yO0TOlAi6GwgJc0fT/fzPfmzet0crmD7HsFBAvQbrcrw+Gw5fu+AfOYvgylJ4TwCoVCs1ardYTruqfj8fgV5OUMSVVT93VdP9dAzpVvm5wJHZFbg2LQ2pEYOlZ/oiDvwNcsFoseY4PBwMCrhaeCJyKWZU37KOJcYdi27QdhcuuBIb073BvTNL8ln4NeeR6NRi/wxZKQcGurQs5oNhqLshzVTMBewW/LMU3TTNlO0ieTiStjYhUIyi6DAp0xbEdgTt+LE0aCKQw24U4llsCs4ZRJrYopB6RwqnpA1YQ5NGFZ1YQ41Z5S8IQQdP5laEBRJcD4Vj5DEsW2gE6s6g3d/YP/g+BDnT7GNi2qCjTwGd6riBzHaaCEd3Js01vwCPIbmWBRx1nwAN/1ov+/drgFWIlfKpVukyYihtgkXNp4mABK+1GtVr+SBhJDbBIubVw+Cd/TDgKO2DPiN3YUo6y/nDCNEIsqTKH1en2tcwA9FKEItyDi3aIh8Gl1sRrVnSDzNFDJT1bAy5xpOYGn5fP5JuL95ZjMIn1ya7j5dPGfv0A5eAnpZUY3n5jXcoec5J67D9q+VuAPM47D3XaSeL4AAAAASUVORK5CYII=&quot;); background-repeat: no-repeat; background-attachment: scroll; background-size: 16px 18px; background-position: 98% 50%;">
                </div>
            </div>

            <div class="form-group">
                <div align="left">
                    <label for="last">Last Name*</label> <input type="text" class="form-control" id="last" name="last"
                                                                required="" placeholder="Enter Your Lastname"></div>
            </div>

            <div class="form-group">
                <div align="left">
                    <label for="email">Email*</label> <input type="email" class="form-control" id="email"
                                                             name="email" required="" aria-describedby="emailHelp"
                                                             placeholder="Enter email"></div>
            </div>

            <div class="form-group">
                <div align="left">
                    <label for="pwd">Password*</label> <input type="password" class="form-control" required=""
                                                              id="pwd" name="pwd" placeholder="Password"
                                                              style="background-image: url(&quot;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR4nGP6zwAAAgcBApocMXEAAAAASUVORK5CYII=&quot;);">
                </div>
            </div>

            <div class="form-group">
                <div align="left">
                    <label for="street">Street*</label> <input type="text" class="form-control" required=""
                                                               id="street" name="street"
                                                               placeholder="Enter Your Street"></div>
            </div>

            <div class="form-group">
                <div align="left">
                    <label for="city">City*</label> <input type="text" class="form-control" id="city" name="city"
                                                           required="" placeholder="Enter Your City"></div>
            </div>

            <div class="form-group">
                <div align="left">
                    <label for="state">State*</label> <select id="state" class="form-control">
                    <option value="0" selected="">State</option>
                    <option value="1">Alabama</option>
                    <option value="2">Alaska</option>
                    <option value="3">Arkansas</option>
                    <option value="4">Arizona</option>
                    <option value="5">California</option>
                    <option value="6">Colorado</option>
                    <option value="7">Connecticut</option>
                    <option value="8">Delaware</option>
                    <option value="9">District of Colombia</option>
                    <option value="10">Florida</option>
                    <option value="11">Georgia</option>
                    <option value="12">Hawaii</option>
                    <option value="13">Idaho</option>
                    <option value="14">Illinois</option>
                    <option value="15">Indiana</option>
                    <option value="16">Iowa</option>
                    <option value="17">Kansas</option>
                    <option value="18">Kentucky</option>
                    <option value="19">Louisiana</option>
                    <option value="20">Maine</option>
                    <option value="21">Maryland</option>
                    <option value="22">Massachusetts</option>
                    <option value="23">Michigan</option>
                    <option value="24">Minnesota</option>
                    <option value="25">Mississippi</option>
                    <option value="26">Missouri</option>
                    <option value="27">Montana</option>
                    <option value="28">Nebraska</option>
                    <option value="29">Nevada</option>
                    <option value="30">New Hampshire</option>
                    <option value="31">New Jersey</option>
                    <option value="32">New Mexico</option>
                    <option value="33">New York</option>
                    <option value="34">North Carolina</option>
                    <option value="35">North Dakota</option>
                    <option value="36">Ohio</option>
                    <option value="37">Oklahoma</option>
                    <option value="38">Oregon</option>
                    <option value="39">Pennsylvania</option>
                    <option value="40">Rhode Island</option>
                    <option value="41">South Carolina</option>
                    <option value="42">South Dakota</option>
                    <option value="43">Tennessee</option>
                    <option value="44">Texas</option>
                    <option value="45">Utah</option>
                    <option value="46">Vermont</option>
                    <option value="47">Virginia</option>
                    <option value="48">Washington</option>
                    <option value="49">West Virginia</option>
                    <option value="50">Wisconsin</option>
                    <option value="51">Wyoming</option>
                </select></div>
            </div>

            <div class="form-group">
                <div align="left">
                    <label for="zip">Zip*</label> <input type="text" class="form-control" id="zip" name="zip"
                                                         required="" placeholder="Enter Your ZIP"></div>
            </div>

            <div class="form-group">
                <div align="left">
                    <label for="school">School Name*</label> <input type="text" class="form-control" id="school"
                                                                    name="school"
                                                                    placeholder="Enter Your School Name"></div>
            </div>

            <div class="form-group">
                <div align="left">
                    <label for="class">Class Name*</label> <input type="text" class="typeahead" autocomplete="off"
                                                                  spellcheck="false" id="class" name="class"
                                                                  required="" placeholder="Enter Your Class Name"
                                                                  style="display: block;
                                                                                                                 width: 100%;
                                                                                                                 height: @input-height-base;
                                                                                                                 padding: @padding-base-vertical @padding-base-horizontal;
                                                                                                                 font-size: @font-size-base;
                                                                                                                 line-height: @line-height-base;
                                                                                                                 color: @input-color;
                                                                                                                 background-color: @input-bg;
                                                                                                                 background-image: none;
                                                                                                                 border: 1px solid @input-border;
                                                                                                                 border-radius: @input-border-radius; ">
                </div>
            </div>

            <div class="form-group">
                <div align="left">
                    <label for="cardholder">Card Holder*</label> <input type="text" class="form-control"
                                                                        id="cardholder" name="cardholder"
                                                                        required=""
                                                                        placeholder="Enter Your Card Holder Name">
                </div>
            </div>

            <div class="form-group">
                <div align="left">
                    <label for="cardnumber">Card Number*</label> <input type="text" class="form-control"
                                                                        id="cardnumber" name="cardnumber"
                                                                        required=""
                                                                        placeholder="Enter Your Card Number"></div>
            </div>

            <div class="form-group">
                <div align="left">
                    <label for="cvv">CVV code*</label> <input type="text" class="form-control" id="cvv" name="cvv"
                                                              required="" placeholder="Enter Your Card CVV"></div>
            </div>

            <div class="form-group">
                <div align="left">
                    <label for="card_month">Expiration Month*</label> <select id="cardmonth" class="form-control">
                    <option value="0" selected="">Month</option>
                    <option value="01">01</option>
                    <option value="02">02</option>
                    <option value="03">03</option>
                    <option value="04">04</option>
                    <option value="05">05</option>
                    <option value="06">06</option>
                    <option value="07">07</option>
                    <option value="08">08</option>
                    <option value="09">09</option>
                    <option value="10">10</option>
                    <option value="11">11</option>
                    <option value="12">12</option>
                </select></div>
            </div>
            <div class="form-group">
                <div align="left">
                    <label for="card_year">Expiration Year*</label> <select id="cardyear" class="form-control">
                    <option value="0" selected="">Year</option>
                    <option value="2017">2017</option>
                    <option value="2018">2018</option>
                    <option value="2019">2019</option>
                    <option value="2020">2020</option>
                    <option value="2021">2021</option>
                    <option value="2022">2022</option>
                    <option value="2023">2023</option>
                    <option value="2024">2024</option>
                    <option value="2025">2025</option>
                    <option value="2026">2026</option>
                    <option value="2027">2027</option>
                    <option value="2028">2028</option>
                    <option value="2029">2029</option>
                    <option value="2030">2030</option>
                </select></div>
            </div>
            <div align="center">
                <div class="form-group">
                    <div align="center">
                        <div class="text-error" id="form_err"></div>
                        <div class="form-group dsR1141">
                            <div align="center">
                                <div class="text-info" id="form_info"></div>
                                <div class="form-group dsR1140">
                                    <div align="center">
                                        <div class="text-info" id="ajax_loader"
                                             style="display:none;text-align: center;">
                                            <img src="assets/images/ajax.gif"></div>
                                        <br>
                                        <button type="submit" class="btn btn-default">Submit</button>
                                    </div>

                                    <div align="center">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </form>
    </div>
</div>

<!-- Optional JavaScript -->
<!-- jQuery first, then Popper.js, then Bootstrap JS -->
<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"
        integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
        crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"
        integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
        crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"
        integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
        crossorigin="anonymous"></script>

<!-- jQuery library -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>


<script type="text/javascript"
        src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-3-typeahead/4.0.1/bootstrap3-typeahead.js"></script>

<!-- Share this Library -->
<script type='text/javascript'
        src='//platform-api.sharethis.com/js/sharethis.js#property=5ab0b082b338830013654f88&product=inline-share-buttons'
        async='async'></script>

<script type="text/javascript">

    var getUrlParameter = function getUrlParameter(sParam) {
        var sPageURL = decodeURIComponent(window.location.search.substring(1)),
            sURLVariables = sPageURL.split('&'),
            sParameterName,
            i;

        for (i = 0; i < sURLVariables.length; i++) {
            sParameterName = sURLVariables[i].split('=');

            if (sParameterName[0] === sParam) {
                return sParameterName[1] === undefined ? true : sParameterName[1];
            }
        }
    };

    $.get('https://www.newsfactsandanalysis.com/lms/custom/students/groups.json', function (data) {
        $("#class").typeahead({source: data, items: 256000});
    });

    /*
    $.get('https://www.newsfactsandanalysis.com/lms/custom/students/un.json', function (data) {
        $("#school").typeahead({source: data, items: 256000});
    });
    */

    var groupid = getUrlParameter('groupid');
    console.log('Group ID: ' + groupid);
    if (jQuery.type(groupid) !== "undefined") {
        var url = 'https://www.newsfactsandanalysis.com/lms/custom/students/get_class_name.php';
        $.post(url, {groupid: groupid}).done(function (data) {
            console.log('Server response: ' + data);
            var item = jQuery.parseJSON(data);
            var name = item.name;
            var price = item.price;
            var school = item.school;
            $('#class').val(name);
            $('#school').val(school);
            $('#price').val(price);      // hidden value
            $('#ui_price').html(price);  // visible value
        });
    } // end if
    else {
        var priceUrl = 'https://www.newsfactsandanalysis.com/lms/custom/students/get_basic_price.php';
        $.post(priceUrl, {id: 1}).done(function (price) {
            $('#price').val(price); // hidden value;
            $('#ui_price').html(price); // visible for students
        });
    } // end else

    $("#student_signup").submit(function (event) {
        event.preventDefault();
        var state = $('#state').val();
        var cardmonth = $('#cardmonth').val();
        var cardyear = $('#cardyear').val();
        var cardholder = $('#cardholder').val();
        $('#form_err').html('');
        $('#form_info').html('');
        if (state > 0 && cardmonth > 0 && cardyear > 0 && cardholder != '') {
            var amount = $('#price').val();

            var groupname = $('#class').val();
            console.log('Class name: ' + groupname);
            var email = $('#email').val();
            var pwd = $('#pwd').val();

            var clean_holder = cardholder.replace(/\s\s+/g, ' ');
            var names_arr = clean_holder.split(" ");

            var firstname, lastname;

            console.log('names array length: ' + names_arr.length);

            if (names_arr.length == 1) {
                $('#form_err').html('Please provide correct card holder name separated by space');
                return;
            }

            if (names_arr.length == 2) {
                console.log('Two names case ....');
                console.log('Holder name: ' + cardholder);
                firstname = names_arr[0];
                lastname = names_arr[1];
                console.log('Billing firstname: ' + firstname);
                console.log('Billing lastname: ' + lastname);
                if (typeof (firstname) === "undefined" || firstname == '' || typeof (lastname) === "undefined" || lastname == '') {
                    $('#form_err').html('Please provide correct card holder name separated by space');
                    return;
                }
            } // end if names_arr.length == 2

            if (names_arr.length == 3) {
                console.log('Three names case ...');
                console.log('Holder name: ' + cardholder);
                firstname = names_arr[0] + ' ' + names_arr[1];
                lastname = names_arr[2];
                console.log('Billing firstname: ' + firstname);
                console.log('Billing lastname: ' + lastname);
                if (typeof (firstname) === "undefined" || firstname == '' || typeof (lastname) === "undefined" || lastname == '') {
                    $('#form_err').html('Please provide correct card holder name separated by space');
                    return;
                }
            } // end if names_arr.length == 3


            $('#form_err').html('');
            var url = '/lms/custom/tutors/is_email_exists.php';
            $.post(url, {email: email}).done(function (data) {
                if (data == 0) {
                    $('#form_err').html('');
                    var url = '/lms/custom/tutors/is_group_exists.php';
                    $.post(url, {groupname: groupname}).done(function (data) {
                        if (data > 0) {
                            $('#ajax_loader').show();
                            var user = {
                                item: 'NewsFacts & Analysis - Tuition',
                                courseid: 2,
                                amount: amount,
                                firstname: $('#first').val(),
                                lastname: $('#last').val(),
                                email: $('#email').val(),
                                pwd: $('#pwd').val(),
                                street: $('#street').val(),
                                city: $('#city').val(),
                                state: $('#state').val(),
                                zip: $('#zip').val(),
                                school: $('#school').val(),
                                title: 'Student',
                                dep: 'n/a',
                                site: 'n/a',
                                class: groupname,
                                cardholder: cardholder,
                                cardnumber: $('#cardnumber').val(),
                                cvv: $('#cvv').val(),
                                cardmonth: $('#cardmonth').val(),
                                cardyear: $('#cardyear').val()
                            };
                            var url = '/lms/custom/students/students_signup.php';
                            $.post(url, {user: JSON.stringify(user)}).done(function (data) {
                                console.log('Server response: ' + data);
                                $('#ajax_loader').hide();
                                if (data != 'ok') {
                                    $('#form_err').html("<span style='color:black;'>" + data + "</span>");
                                }
                                else {
                                    var url = 'https://www.newsfactsandanalysis.com/registerthankyou.html?u=' + email + '&p=' + pwd;
                                    window.location.href = url;
                                }
                            }); // end of post
                        } // end if data>0 (group exists)
                        else {
                            $('#form_err').html('Class does not exist');
                        } // end else
                    }); // end of group post
                } // end if data==0 (email is not in use)
                else {
                    $('#form_err').html('This email is already in use');
                } // end else
            }); // end of email post
        } // end if all form inputs are ok
        else {
            $('#form_err').html('Please provide all required fields');
        }
    });


</script>

</body>